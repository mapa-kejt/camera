<!DOCTYPE html>
<html>
  <head>
    <title>Hello Camera</title>
    <script src="https://unpkg.com/dynamsoft-camera-enhancer@2.1.0/dist/dce.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@2.0.2/dist/jsQR.js"></script>
  </head>

  <body>
    <button id="capture">aj plssss</button>
    <div id="enhancerUIContainer" style="height: 100vh"></div>
    <script>
      let enhancer = null;
      let videoOpened = false;

      async function openCamera() {
        enhancer = await Dynamsoft.DCE.CameraEnhancer.createInstance();
        document
          .getElementById("enhancerUIContainer")
          .appendChild(enhancer.getUIElement());
        await enhancer.open(true);
        startDetection();
      }

      function startDetection() {
        enhancer.onFrame = async (frame) => {
          const qrCode = jsQR(frame.data, frame.width, frame.height);

          if (qrCode && qrCode.data === "Crkva sv.Stosije") {
            // Replace with the specific data of your QR code
            openVideo();
          }
        };
      }

      function openVideo() {
        if (!videoOpened) {
          // Create a video element
          const video = document.createElement("video");
          video.src = "images/video.mp4"; // Replace with the path to your video file
          video.controls = true;
          video.autoplay = true;

          // Append the video element to the document body
          document.body.appendChild(video);

          videoOpened = true;
        }
      }

      document.getElementById("capture").onclick = () => {
        if (enhancer) {
          let frame = enhancer.getFrame();

          let width = screen.availWidth;
          let height = screen.availHeight;
          let popW = 640,
            popH = 640;
          let left = (width - popW) / 2;
          let top = (height - popH) / 2;

          popWindow = window.open(
            "",
            "popup",
            "width=" +
              popW +
              ",height=" +
              popH +
              ",top=" +
              top +
              ",left=" +
              left +
              ", scrollbars=yes"
          );

          popWindow.document.body.appendChild(frame.canvas);
        }
      };

      (async () => {
        enhancer = await Dynamsoft.DCE.CameraEnhancer.createInstance();
        document
          .getElementById("enhancerUIContainer")
          .appendChild(enhancer.getUIElement());
        await enhancer.open(true);
        startDetection();
      })();
    </script>
  </body>
</html>
