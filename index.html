<!DOCTYPE html>
<html>
  <head>
    <title>Hello Camera</title>
    <script src="https://unpkg.com/dynamsoft-camera-enhancer@2.1.0/dist/dce.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quagga"></script>
  </head>
  <body>
    <button id="capture">Capture</button>
    <div id="enhancerUIContainer" style="height: 100vh"></div>
    <video id="videoPlayer" controls></video>
    <script>
      let enhancer = null;

      async function setupCamera() {
        const videoElement = document.createElement("video");
        videoElement.width = 640;
        videoElement.height = 480;

        const stream = await navigator.mediaDevices.getUserMedia({
          video: true,
        });

        videoElement.srcObject = stream;
        await videoElement.play();

        return videoElement;
      }

      async function main() {
        enhancer = await Dynamsoft.DCE.CameraEnhancer.createInstance();
        document
          .getElementById("enhancerUIContainer")
          .appendChild(enhancer.getUIElement());
        await enhancer.open(true);

        const videoPlayer = document.getElementById("videoPlayer");
        const videoUrl = "images/video.mp4"; // Replace with the URL or path to your video

        Quagga.init(
          {
            inputStream: {
              name: "Live",
              type: "LiveStream",
              target: document.querySelector("#enhancerUIContainer video"),
            },
            decoder: {
              readers: ["ean_reader"],
            },
          },
          function (err) {
            if (err) {
              console.error(err);
              return;
            }
            Quagga.start();

            Quagga.onDetected(function (result) {
              const code = result.codeResult.code;
              if (code === "your-qr-code-data") {
                videoPlayer.src = videoUrl;
                Quagga.stop();
              }
            });
          }
        );
      }

      document.getElementById("capture").onclick = main;
    </script>
  </body>
</html>
